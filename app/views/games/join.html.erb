<%= render 'game' ,:game => @game %>
<p id="result" ></p>
<script type="text/javascript">
		var turn=false;
	var user=2;
	var time = 3000;
	var started = true;
	var changes=false;
	var gameEnded=false;
	var turncheck = setInterval(function(){
	if(!gameEnded){
		$.getJSON('/games/turn.json?game=' + <%= @game.id %>+'&user='+<%= @game.user2.id %>, function(isMyTurn)
		{
		turn=isMyTurn;
		if(turn && !changes){
			changes=true;
		}
		});
		}
	}
	,time);

	var changesCheck = setInterval(function(){
		if(changes && !gameEnded){
			$.getJSON('/games/changes.json?game=' + <%= @game.id %>
			, function(data) {
				for(var i = 1; i < data.length; i++) {
					if(data[i-1] == null)
						document.getElementById("e" + i).innerHTML = '';
					else
						document.getElementById("e" + i).innerHTML = data[i-1];
				};
				if(data[data.length-1]=="X_Win"){
						gameEnded=true;
						document.getElementById("result").innerHTML="You Lost";
					}else if(data[data.length-1]=="O_Win"){
						gameEnded=true;
						document.getElementById("result").innerHTML="You Won";
					}else if(data[data.length-1]=="Draw"){
						gameEnded=true;
						document.getElementById("result").innerHTML="Game Draw";
					}
			});
			}
		}
		,1000);
</script>